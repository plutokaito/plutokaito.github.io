<!doctype html><html dir=ltr lang=cn data-theme><head><title>江临筱轩 | 使用 SpringBoot 发送应用系统邮件</title><meta charset=utf-8><meta name=generator content="Hugo 0.82.0"><meta name=viewport content="width=device-width,initial-scale=1,viewport-fit=cover"><meta name=description content="该篇文章讲述的是怎么使用 Springboot 自带的 email 发送邮件"><meta name=google-site-verification content="L6xe0i6HBiJAWiH5QHEw9sqEVLcBuUl5vn_4ZkCprXw"><link rel=stylesheet href=/css/main.min.69a557b4fc895e1566037155c2b37c752bb8ccf82803bf8551c60ae44f0f4e23.css integrity="sha256-aaVXtPyJXhVmA3FVwrN8dSu4zPgoA7+FUcYK5E8PTiM=" crossorigin=anonymous type=text/css><link rel=stylesheet href=/css/markupHighlight.min.f798cbda9aaa38f89eb38be6414bd082cfd71a6780375cbf67b6d2fb2b96491e.css integrity="sha256-95jL2pqqOPies4vmQUvQgs/XGmeAN1y/Z7bS+yuWSR4=" crossorigin=anonymous type=text/css><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.1/css/all.min.css integrity="sha512-+4zCK9k+qNFUR5X+cKL9EIR+ZOhtIloNl9GIKS57V1MyNsYpYcUrUeQc9vNfzsWfV28IaLL3i96P9sdNyeRssA==" crossorigin=anonymous><link rel="shortcut icon" href=/favicon.ico type=image/x-icon><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=canonical href=/post/spring_boot_email/><script type=text/javascript src=/js/anatole-header.min.0c05c0a90d28c968a1cad4fb31abd0b8e1264e788ccefed022ae1d3b6f627514.js integrity="sha256-DAXAqQ0oyWihytT7MavQuOEmTniMzv7QIq4dO29idRQ=" crossorigin=anonymous></script><script type=text/javascript src=/js/anatole-theme-switcher.min.7fd87181cdd7e8413aa64b6867bb32f3a8dc242e684fc7d5bbb9f600dbc2b6eb.js integrity="sha256-f9hxgc3X6EE6pktoZ7sy86jcJC5oT8fVu7n2ANvCtus=" crossorigin=anonymous></script><meta name=twitter:card content="summary"><meta name=twitter:title content="使用 SpringBoot 发送应用系统邮件"><meta name=twitter:description content="该篇文章讲述的是怎么使用 Springboot 自带的 email 发送邮件"></head><body><div class="sidebar animated fadeInDown"><div class=logo-title><div class=title><img src=/images/avatar.png alt="profile picture"><h3 title><a href=/>I'm KaitoShy</a></h3><div class=description><p>Java Developer</p></div></div></div><ul class=social-links><li><a href=https://github.com/plutokaito rel=me aria-label=GitHub><i class="fab fa-github fa-2x" aria-hidden=true></i></a></li><li><a href=mailto:kaito78@163.com rel=me aria-label=e-mail><i class="fas fa-envelope fa-2x" aria-hidden=true></i></a></li></ul><div class=footer><div class=by_farbox>&copy; 江临筱轩 2021 - 2022</div></div></div><div class=main><div class="page-top animated fadeInDown"><a role=button class=navbar-burger data-target=navMenu aria-label=menu aria-expanded=false><span aria-hidden=true></span><span aria-hidden=true></span><span aria-hidden=true></span></a><ul class=nav id=navMenu><li><a href=/ title>主页(Home)</a></li><li><a href=/post/ title>博客(Blog)</a></li><li><a href=/about/ title>关于(About)</a></li><li><a href=/tags/ title>标签(tags)</a></li><li><a href=/contact/ title>联系(Contact)</a></li><li class=theme-switch-item><a class=theme-switch title="Switch Theme"><i class="fas fa-adjust fa-fw" aria-hidden=true></i></a></li></ul></div><div class=autopagerize_page_element><div class=content><div class="post animated fadeInDown"><div class=post-content><div class=post-title><h3>使用 SpringBoot 发送应用系统邮件</h3><div class=info><em class="fas fa-calendar-day"></em><span class=date>Tue, May 17, 2022</span>
<em class="fas fa-stopwatch"></em><span class=reading-time></span></div></div><h2 id=前言>前言</h2><p>在一些特定的场景下是需要发送邮件的。比如系统的报警、用户反馈的提醒等等。那么在 SpringBoot 项目中怎么实现呢？</p><h2 id=准备>准备</h2><p>先准备发送的邮箱和密码。这里我建议使用客户端专用密码，没有过期的烦恼。也不会暴露原始的密码。以 <a href=https://work.weixin.qq.com/mail/>腾讯企业邮</a> 为例。 申请发送邮箱需要先绑定微信，才能生成。这里是比较坑的一点，但也是安全起见吧，如果是公司需要申请一下，绑定系统维护人员微信即可。具体设置如下图：
<img src=/images/post/mail/pass-setting.png alt=pass_setting></p><h2 id=导入相应的包>导入相应的包</h2><div class=highlight><pre class=chroma><code class=language-xml data-lang=xml>        <span class=nt>&lt;dependency&gt;</span>
            <span class=nt>&lt;groupId&gt;</span>org.springframework.boot<span class=nt>&lt;/groupId&gt;</span>
            <span class=nt>&lt;artifactId&gt;</span>spring-boot-starter-mail<span class=nt>&lt;/artifactId&gt;</span>
        <span class=nt>&lt;/dependency&gt;</span>
</code></pre></div><p>根据 <a href=https://docs.spring.io/spring-framework/docs/5.3.19/reference/html/integration.html#mail>官方文档</a>，这里使用的是 <a href=https://eclipse-ee4j.github.io/mail/>JavaMail / Jakarta Mail 1.6</a> 。有兴趣的可以自行了解。</p><h2 id=创建-util-包>创建 util 包</h2><p>由于个人习惯的问题，喜欢把这些非业务功能封装成工具类，由于是工具类，那么就不使用依赖注入和查找了。直接使用了 <code>new JavaMailSenderImpl()</code> ,具体 demo 如下。</p><div class=highlight><pre class=chroma><code class=language-java data-lang=java><span class=nd>@Slf4j</span>
<span class=kd>public</span> <span class=kd>class</span> <span class=nc>SendEmailUtil</span> <span class=o>{</span>

    <span class=kd>public</span> <span class=kd>static</span> <span class=kt>void</span> <span class=nf>sendEmail</span><span class=o>(</span><span class=n>String</span> <span class=n>to</span><span class=o>,</span> <span class=n>String</span> <span class=n>subject</span><span class=o>,</span> <span class=n>String</span> <span class=n>content</span><span class=o>)</span> <span class=kd>throws</span> <span class=n>MessagingException</span> <span class=o>{</span>
        <span class=n>JavaMailSenderImpl</span> <span class=n>sender</span> <span class=o>=</span> <span class=k>new</span> <span class=n>JavaMailSenderImpl</span><span class=o>();</span>
        <span class=n>sender</span><span class=o>.</span><span class=na>setPassword</span><span class=o>(</span><span class=s>&#34;专用密码&#34;</span><span class=o>);</span> <span class=c1>// 密码
</span><span class=c1></span>        <span class=n>sender</span><span class=o>.</span><span class=na>setPort</span><span class=o>(</span><span class=n>465</span><span class=o>);</span>
        <span class=n>sender</span><span class=o>.</span><span class=na>setUsername</span><span class=o>(</span><span class=s>&#34;xxx@xxxxxbbb.com&#34;</span><span class=o>);</span> <span class=c1>// 发送者邮箱
</span><span class=c1></span>        <span class=n>sender</span><span class=o>.</span><span class=na>setHost</span><span class=o>(</span><span class=s>&#34;smtp.exmail.qq.com&#34;</span><span class=o>);</span>
        <span class=n>sender</span><span class=o>.</span><span class=na>setProtocol</span><span class=o>(</span><span class=s>&#34;smtps&#34;</span><span class=o>);</span> <span class=c1>// 协议
</span><span class=c1></span>        <span class=n>MimeMessage</span> <span class=n>message</span> <span class=o>=</span> <span class=n>sender</span><span class=o>.</span><span class=na>createMimeMessage</span><span class=o>();</span>
        <span class=n>MimeMessageHelper</span> <span class=n>helper</span> <span class=o>=</span> <span class=k>new</span> <span class=n>MimeMessageHelper</span><span class=o>(</span><span class=n>message</span><span class=o>);</span>

        <span class=n>helper</span><span class=o>.</span><span class=na>setFrom</span><span class=o>(</span><span class=s>&#34;xxx@xxxxxbbb.com&#34;</span><span class=o>);</span> <span class=c1>// 发送者邮箱
</span><span class=c1></span>        <span class=n>helper</span><span class=o>.</span><span class=na>setTo</span><span class=o>(</span><span class=n>to</span><span class=o>);</span>
        <span class=n>helper</span><span class=o>.</span><span class=na>setSubject</span><span class=o>(</span><span class=n>subject</span><span class=o>);</span>
        <span class=n>helper</span><span class=o>.</span><span class=na>setText</span><span class=o>(</span><span class=n>content</span><span class=o>);</span>

        <span class=n>sender</span><span class=o>.</span><span class=na>send</span><span class=o>(</span><span class=n>message</span><span class=o>);</span>
    <span class=o>}</span>
<span class=o>}</span>
</code></pre></div><p>为什么协议要使用 smtps 呢？ 根据 <a href=https://en.wikipedia.org/wiki/SMTPS>wiki</a> 上解释来看</p><blockquote><p>Some email service providers allow their customers to use the SMTPS protocol to access a TLS-encrypted version of the &ldquo;submission&rdquo; service on port 465.</p></blockquote><p>一些邮件服务允许在 465 端使用 SMTPS 协议。 而腾讯企业使用的端口就是 465。</p><h2 id=使用>使用</h2><p>使用以下代码便可收到邮件</p><div class=highlight><pre class=chroma><code class=language-java data-lang=java><span class=n>SendEmailUtil</span><span class=o>.</span><span class=na>sendEmail</span><span class=o>(</span><span class=s>&#34;aa@qq.com&#34;</span><span class=o>,</span> <span class=s>&#34;aa&#34;</span><span class=o>,</span> <span class=s>&#34;content&#34;</span><span class=o>);</span>
</code></pre></div><p>将 “aa@qq.com” 替换成你自己的邮箱便能收到邮件了。</p></div><div class=post-footer><div class=info><span class=separator><a class=tag href=/tags/spring/>spring</a><a class=tag href=/tags/springboot/>springboot</a><a class=tag href=/tags/mail/>mail</a></span></div></div></div></div></div></div><script type=text/javascript src=/js/medium-zoom.min.83cb1dd5fea8d42d87d1e601a07faa73089ad0ef9ccfe5daf6041289ebcc4e46.js integrity="sha256-g8sd1f6o1C2H0eYBoH+qcwia0O+cz+Xa9gQSievMTkY=" crossorigin=anonymous></script><script async src="https://www.googletagmanager.com/gtag/js?id=G-Z2224MZXW3"></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag('js',new Date),gtag('config','G-Z2224MZXW3')</script><script async defer src=https://scripts.simpleanalyticscdn.com/latest.js></script><noscript><img src=https://queue.simpleanalyticscdn.com/noscript.gif alt></noscript></body></html>